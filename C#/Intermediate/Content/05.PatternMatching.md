# ëª©ì°¨

<br>

---

# íŒ¨í„´ ë§¤ì¹­

ì„ì˜ì˜ ê°œì²´ê°€ íŠ¹ì • íŒ¨í„´(ëª¨ì–‘, íƒ€ì…, ê°’)ì„ ë§Œì¡± í•˜ëŠ”ì§€ ì¡°ì‚¬ í•˜ëŠ” ê²ƒ

1. type pattern matching (C# ì´ˆê¸°ë¶€í„° ì§€ì›, 7.0ì—ì„œ ê¸°ëŠ¥ ì¶”ê°€)
2. var pattern matching (C# 7.0)
3. const pattern matching (C# 7.0)
4. switch expression (C# 8.0)

<br>

---

## type pattern matching

Baseê°ì²´ë¥¼ ë°›ì•„ì„œ ì„¸ë¶€ êµ¬í˜„ ì‚¬í•­ì„ í™•ì¸ í• ë•Œ `is`ë¥¼ í†µí•´ì„œ ê°€ëŠ¥í•˜ë‹¤.

`ê°ì²´ is íƒ€ì…`

```C#
    public static void Draw(Shape s)
    {
        if ( s is Circle )
        {
            Circle c1 = (Circle)s;      //ShapeëŠ” radiusê°€ ì—†ê¸° ë•Œë¬¸ì— ìºìŠ¤íŒ… í•„ìš”.
            double d = c1.radius;
        }
    }
```

í•˜ì§€ë§Œ ìœ„ì™€ ê°™ì´ ìºìŠ¤íŒ…ê¹Œì§€ í•˜ëŠ” ê²½ìš°ê°€ ë§¤ìš° ë§ì•„ì„œ C#(7.0)ì—ì„œëŠ” ì´ë¥¼ ì§€ì›í•´ ì¤€ë‹¤.

`ê°ì²´ is type ë³€ìˆ˜`

ê°ì²´ë¥¼ ë³€ìˆ˜ë¡œ ìºìŠ¤íŒ…í•´ì„œ ì œê³µê¹Œì§€ í•¨.

```C#
if (s is Circle c1)
{
    double d = c1.radius;
}
```

varë„ ì œê³µ í•œë‹¤.

```C#
// var pattern matching
if (s is var c2) // var c2 = s, í•­ìƒ ì°¸ì´ ë‚˜ì˜¤ë‚˜ switchë¬¸ì—ì„œ ì‚¬ìš©ë¨.
{

}
```

<br>

---

## const pattern matching

ì•„ë˜ì˜ ë‘ ì½”ë“œëŠ” ê¸°ëŠ¥ì ìœ¼ë¡œ ë™ì¼í•˜ë‹¤.

```C#
if ( n is 10 ) { }// const pattern matching
if ( n == 10 ) { }
```

í•˜ì§€ë§Œ í•´ë‹¹ ìƒí™©ì—ì„œ ë‹¬ë¼ì§ˆ ê²½ìš°ê°€ ìˆë‹¤.

```C#
if (obj == (object)10)              // ok
    Console.WriteLine("True");
else
    Console.WriteLine("False");     //í•´ë‹¹ ì¶œë ¥ì´ ë¨.
```

- why) falseê°€ ì¶œë ¥ì´ ë˜ëŠ”ê°€?

  objëŠ” stack, 10ì€ heapì— ì˜¬ë¼ê°€ê²Œ ëœë‹¤. ì´ë–„ ì¼€ìŠ¤íŒ…ì„ ì§„í–‰í•˜ê²Œ ë˜ë©´ ìƒˆë¡œìš´ ë©”ëª¨ë¦¬ì— 10ì„ ìƒì„±í•´ì„œ objê°€ ê°€ë¥´í‚¤ê²Œ ëœë‹¤.

  ê·¸ë ‡ê¸° ë•Œë¬¸ì— ë‘ 10ì€ ì£¼ì†Œê°’ì´ ë‹¤ë¥´ê²Œ ëœë‹¤.

  ì¦‰ Boxing

    <img src="../Image/ConstPattern.png" width=700pv/>

trueê°€ ë‚˜ì˜¤ê²Œ í•˜ë ¤ë©´ ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•´ì„œ UnBoxingí•œë‹¤.ã…‚

```C#
if ((int)obj == 10)                 // ok
    Console.WriteLine("True");      //í•´ë‹¹ ì¶œë ¥ì´ ë¨.
else
    Console.WriteLine("False");
```

ìœ„ëŠ” ìƒë“± ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì˜€ìœ¼ë‚˜ isë¥¼ ì“°ê²Œ ë˜ë©´ ìºìŠ¤íŒ…ì„ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

> ì•„ë˜ì™€ ìœ„ëŠ” ILì½”ë“œê°€ ë™ì¼í•¨.

```C#
if (obj is 10)
{
}
```

IFë¬¸ ë³´ë‹¤ Switchë¬¸ì„ ì‚¬ìš©í• ë•Œ ë” íš¨ê³¼ì ì´ë‹¤.

<br>

---

### Switchë¬¸ì„ ì‚¬ìš©í•œ const pattern matching

| Type pattern matching | var pattern matching | const pattern matching |
| --------------------- | -------------------- | ---------------------- |
| `if( o is Circle c1)` | `if( o is var c1)`   | `if( o is 10)`         |

1.  const pattern matching

    ```C#
    // ê°’ì„ ì¡°ì‚¬ í•œë‹¤.
    case null:
        break;
    ```

2.  type pattern matching

    í•´ë‹¹ íƒ€ì…ì„ ì¡°ì‚¬í•œë‹¤

    ìºìŠ¤íŒ… ê¹Œì§€ ìˆ˜í–‰

    ```C#
     // type pattern matching
     case Circle c:
         break;
    ```

    - whenì„ í†µí•´ ì¡°ê±´ì„ ì¶”ê°€ í•  ìˆ˜ ë„ ìˆë‹¤.

      ```C#
      //whenì„ í†µí•´ ì¡°ê±´ì„ ì¶”ê°€í•¨.
      case Rectangle r when r.width == r.height:
          break;
      ```

    â— whenê³¼ ìŠ¤ìœ„ì¹˜ ë¬¸ì„ ì‚¬ìš©í• ë•Œ ì£¼ì˜ì 

    > ë³´í¸ì ì¸ íŠ¹ì„±ì„ ì•„ë˜ì— ë‘¬ì•¼ í•œë‹¤.<br>
    > ê·¸ë ‡ì§€ ì•Šì„ ê²½ìš° ë³´í¸ì ì¸ íŠ¹ì„±ì—ì„œ ê±¸ë ¤ì„œ ì•„ë˜ì˜ ì¡°ê±´ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

```C#
switch (s)
{
    // const pattern matching
    case null:
        break;

    // type pattern matching
    case Circle c:
        break;

    //whenì„ í†µí•´ ì¡°ê±´ì„ ì¶”ê°€í•¨.
    case Rectangle r when r.width == r.height:
        break;

    // í•´ë‹¹ ë¼ì¸ì´ ìœ„ì˜ caseìœ„ì— ìˆì„ ê²½ìš° ìœ„ì˜ caseëŠ” ì‹¤í–‰ì´ ì•ˆë¨
    case Rectangle r:
        break;

    default:
        break;
}
```

<br>

---

## var Pattern Matching

varì„ í†µí•´ì—¬ í•´ë‹¹ íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë”°ë¼ê°ˆ ìˆ˜ ìˆë‹¤.

ì•„ë˜ì™€ ê°™ì´ ì‘ì„±í•˜ë©´, r ì€ sì˜ íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ë”°ë¼ê°€ë©° í•  ìˆ˜ ìˆë‹¤.

```C#
public static void Draw(Shape s)
{
    switch (s)
    {
        // ì—¬ëŸ¬ íƒ€ì… ì˜ˆì™¸ ì½”ë“œë¥¼ ì¤„ì¼ ìˆ˜ ìˆìŒ.
        case var r when (group.Contains(r)) :
            break;

        default: break;
    }
    }
```

<br>

---

# Switch Express

C# 8.0 ì—ì„œ ìƒˆë¡œìš´ switchë¬¸ë²•ì„ ì¶”ê°€ ì‹œì¼°ë‹¤.

```C#
int s = n switch { 10 => 11, 20 => 22, 30 => 33, _ => 100 };
```

ì´ë¥¼ Switch Expressë¼ê³  í•œë‹¤.

ğŸ’¡ `_`ì€ defaultì´ë‹¤.

ğŸ’¡ ë³´í†µ ë¶„ê¸°ë§ˆë‹¤ ê°œí–‰í•´ì„œ í‘œí˜„í•œë‹¤.

<br>

Statment (ë¬¸, ë¬¸ì¥)

- í”„ë¡œê·¸ë¨ì„ êµ¬ì„±í•˜ëŠ” ê¸°ë³¸ ìš”ì†Œ

- C#ì—ì„œ í•˜ë‚˜ì˜ ë¬¸ì¥ì€ ;ë¡œ ì¢…ë£Œëœë‹¤.

- ì–¸ì–´ì— ë”°ë¼ ì •ì˜ê°€ ì•½ê°„ì”© ë‹¤ë¥´ë‹¤.

Expression (í‘œí˜„ì‹)

- ëŒ€ë¶€ë¶„ì–¸ì–´ê°€ ìœ ì‚¬í•œ ì •ì˜ë¥¼ ì‚¬ìš©

- í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ê³„ì‚°ë˜ëŠ” ì‹

  ex) `int n = 2 * 3 + 4 - n; `

- ì—°ì‚°ìì™€ í”¼ì—°ì‚°ìë¡œ êµ¬ì„±

- returnìœ¼ë¡œ í‘œê¸°í•˜ì§€ ì•Šì•„ë„ í•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ë°˜í™˜ëœë‹¤.

- C#ì—ì„œëŠ” ëŒë‹¤ ì²˜ëŸ¼ `=>`ë¥¼ ì´ìš©í•´ì„œ ê°€ëŠ¥í•˜ë‹¤.

```C#
public int square(int n)
{
    return n * n;
}

public int square2(int n) => n * n; //expressiong
```

## ë‹¤ì–‘í•œ Switch Express

1. Type pattern matching
   - í•„ìš” ì—†ëŠ” ë³€ìˆ˜ëŠ” \_ë¡œ í‘œê¸°í•˜ë©´ ìƒì„± ì•ˆí•¨.
   ```C#
   double area = s switch
   {
       null => 0,                                  // const pattern matching
       Point _ => 0,
       Circle c => Math.PI * c.Radius * c.Radius,
       Rectangle r => r.Width * r.Height,
       _ => 0
   };
   ```
2. tuple pattarn

   ë‘ê°€ì§€ ì¸ìë¥¼ ë°›ì•„ì„œ Switchì‚¬ìš© ê°€ëŠ¥.

   ```C#
    int value1 = 0;
    int value2 = 0;

   var ret1 = (value1, value2) switch
   {
       (0, 0) => 0,
       var (a, b) when a > 100 => 100,
       var (a, b) when a <= 100 && b > 100 => 200,
       _ => 300
   };
   ```

3. positional pattern : Deconstructor ê°€ ìˆëŠ” íƒ€ì…

   - Deconstructor ë¡œ ì¸í•´íŠœí”Œë¡œ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— tuple pattarnê°€ëŠ¥

   ```C#
   Point pt = new Point();

   var ret2 = pt switch
   {
       (0, 0) => 0,
       var (a, b) when a > 100 => 100,
       var (a, b) when a <= 100 && b > 100 => 200,
       _ => 300
   };
   ```
